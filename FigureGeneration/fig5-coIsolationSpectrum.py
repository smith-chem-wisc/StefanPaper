import numpy as np
import matplotlib.pyplot as plt
import pandas

def frange(start, stop, step):
    i = start
    while i < stop:
        yield i
        i += step

# This is from Jurkat 12 scan 12333

mz = [0, 0, 0, 0, 0, 0, 162124.125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 98809.40625, 0, 0, 0, 2548705.75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 142358.0469, 0, 0, 195410.3438, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 322681.6563, 0, 0, 1411281.375, 0, 0, 1936653.75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 333969, 0, 0, 202836.7031, 0, 0, 0, 0, 0, 96753.42188, 0, 0, 84754.38281, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 328649.5313, 0, 94499.35156, 0, 889372.375, 0, 1566347.875, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5150338, 0, 0, 0, 0, 0, 223941.7188, 0, 569038, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 258916.7969, 0, 0, 0, 0, 0, 0, 5426417.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84718.61719, 0, 986879.5625, 0, 0, 0, 173286.3438, 0, 0, 0, 0, 0, 0, 0, 0, 3149313.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1559043.75, 0, 0, 164457.3281, 700120.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129633.1406, 0, 0, 0, 0, 0, 304501.6875, 0, 0, 0, 0, 1555357.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 428477.9688, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 292389.5, 0, 0, 0, 0, 0, 1897920.375, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 120417.7813, 91467.00781, 0, 0, 92549.47656, 0, 1119040.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

objects = list(frange(724.65,728.64,0.01))
y_pos = np.arange(len(objects))

print(len(mz))
print(len(objects))
print(len(y_pos))
print(y_pos[0])



height = 3
width = 7 
plt.figure(figsize=(width, height))

plt.bar(y_pos, mz)
plt.xticks(np.arange(35,400,50), [725,725.5, 726,726.5,727,727.5,728,728.5])
plt.xlim([0,400])
plt.ylim([0,6000000])
plt.xlabel('m/z (Th)')
plt.ylabel('Intensity')
plt.title('Scan 12333 in m/z range [724.65,728.64]')

plt.plot([(724.87-724.65)*100,(724.87-724.65+1/2)*100,(724.87-724.65+2/2)*100, (724.87-724.65+3/2)*100], [2800000,1700000,1050000,350000], 'r*', label="Mass 1447.74 charge 2")
plt.plot([(725.4-724.65)*100,(725.4-724.65+1/2)*100,(725.4-724.65+2/2)*100, (725.4-724.65+3/2)*100], [2200000,1800000,900000,500000], 'rs', label="Mass 1448.8 charge 2")
plt.plot([(726.32-724.65)*100,(726.32-724.65+1/3)*100,(726.32-724.65+2/3)*100, (726.32-724.65+3/3)*100, (726.32-724.65+4/3)*100], [5500000,5800000,3700000,1800000,500000], 'ro', label="Mass 2175.96 charge 3")

plt.legend()

plt.tight_layout()

plt.savefig(r'C:\Users\stepa\Source\StefanPaper\fig5-coIsolationSpectrum.png', format='png', dpi=1200)

plt.show()

