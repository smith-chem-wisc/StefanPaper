import numpy as np
import matplotlib.pyplot as plt
import pandas

def frange(start, stop, step):
    i = start
    while i < stop:
        yield i
        i += step

# This is from Jurkat 12 scan 12333

mz = [0, 0, 0, 0, 0, 0, 162124.125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 98809.40625, 0, 0, 0, 2548705.75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 142358.0469, 0, 0, 195410.3438, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 322681.6563, 0, 0, 1411281.375, 0, 0, 1936653.75, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 333969, 0, 0, 202836.7031, 0, 0, 0, 0, 0, 96753.42188, 0, 0, 84754.38281, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 328649.5313, 0, 94499.35156, 0, 889372.375, 0, 1566347.875, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5150338, 0, 0, 0, 0, 0, 223941.7188, 0, 569038, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 258916.7969, 0, 0, 0, 0, 0, 0, 5426417.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 84718.61719, 0, 986879.5625, 0, 0, 0, 173286.3438, 0, 0, 0, 0, 0, 0, 0, 0, 3149313.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1559043.75, 0, 0, 164457.3281, 700120.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 129633.1406, 0, 0, 0, 0, 0, 304501.6875, 0, 0, 0, 0, 1555357.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 428477.9688, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 292389.5, 0, 0, 0, 0, 0, 1897920.375, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 120417.7813, 91467.00781, 0, 0, 92549.47656, 0, 1119040.5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

objects = list(frange(724.65,728.64,0.01))
y_pos = np.arange(len(objects))

height = 6
width = 7 
plt.figure(figsize=(width, height))

##############  MS1

ok = plt.subplot(211)

plt.bar(y_pos, mz)
plt.xticks(np.arange(35,400,50), [725,725.5, 726,726.5,727,727.5,728,728.5])
plt.xlim([0,400])
plt.ylim([0,6000000])
plt.xlabel('m/z (Th)')
plt.ylabel('Intensity')
plt.title('Scan 12333 in m/z range [724.65,728.64]')

plt.plot([(726.32-724.65)*100,(726.32-724.65+1/3)*100,(726.32-724.65+2/3)*100, (726.32-724.65+3/3)*100, (726.32-724.65+4/3)*100], [5500000,5800000,3700000,1800000,500000], 'ro', label="Mass 2175.96 charge 3")
plt.plot([(724.87-724.65)*100,(724.87-724.65+1/2)*100,(724.87-724.65+2/2)*100, (724.87-724.65+3/2)*100], [2800000,1700000,1050000,350000], 'r*', label="Mass 1447.74 charge 2")
plt.plot([(725.4-724.65)*100,(725.4-724.65+1/2)*100,(725.4-724.65+2/2)*100, (725.4-724.65+3/2)*100], [2200000,1800000,900000,500000], 'rs', label="Mass 1448.8 charge 2")

plt.legend()

##############  MS2
ok = plt.subplot(212)

mz = [ 5056.179199, 32802.7207, 2505.087646, 17798.64258, 0, 17001.51172, 0, 25664.54883, 8237.075195, 28441.77832, 0, 0, 25948.25391, 2251.533203, 0, 0, 0, 0, 10489.94873, 13864.64356, 0, 5642.496582, 0, 0, 3764.952881, 10869.22998, 3205.215332, 0, 0, 48955.47022, 0, 3610.465576, 31380.54712, 13405.52637, 3803.329834, 0, 69744.24048, 12447.56934, 0, 0, 20226.781, 13399.70947, 0, 3324.947021, 0, 2778.108398, 7683.030273, 0, 0, 0, 35153.10938, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3560.301758, 0, 0, 0, 9268.387695, 0, 0, 0, 3617.732422, 3612.002686, 0, 0, 19320.95459, 0, 7808.92627, 16197.1582, 0, 0, 0, 0, 0, 6185.438965, 3441.842285, 0, 6399.90332, 0, 0, 0, 2545.905762, 9753.322266, 7710.588379, 0, 3327.761963, 3180.866455, 7982.783935, 0, 0, 6959.035156, 4216.53125, 0, 5670.268555, 0, 0, 0, 7040.166504, 22473.80273, 0, 0, 0, 0, 0, 0, 0, 0, 3540.158447, 0, 0, 0, 0, 0, 0, 0, 17785.28711, 2193.447021, 0, 40135.09473, 0, 6272.979736, 6259.955078, 0, 0, 0, 0, 11617.76465, 0, 87274.53272, 0, 31027.77588, 0, 5073.376953, 2922.136719, 0, 0, 37529.92334, 0, 0, 3714.335449, 0, 0, 0, 16614.12061, 3911.242676, 4471.05957, 63115.71045, 3258.848145, 177374.855, 78328.46484, 2993.374023, 0, 95015.61719, 0, 5104.876465, 0, 0, 3297.185303, 0, 0, 5960.851074, 16795.31738, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7145.68457, 0, 0, 0, 0, 0, 0, 0, 54030.81738, 0, 34549.58789, 21951.93799, 3135.246582, 0, 17550.89844, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6885.176758, 0, 3544.696289, 0, 46999.09082, 0, 0, 0, 0, 0, 0, 0, 8255.105225, 8162.027832, 10161.91016, 0, 27108.85938, 16508.73828, 0, 0, 40506.78125, 4759.006348, 0, 0, 0, 3481.751465, 0, 0, 0, 30472.37695, 10363.64551, 8827.860352, 0, 0, 46965.62573, 3664.224609, 0, 2884.009277, 0, 0, 0, 0, 0, 22501.37891, 0, 0, 6725.70752, 0, 0, 0, 4675.950195, 0, 0, 14214.4502, 0, 0, 0, 0, 0, 0, 0, 0, 6318.080078, 0, 0, 0, 13498.79785, 23342.38232, 0, 0, 4912.638672, 15199.30273, 0, 0, 4760.929199, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4406.008789, 0, 0, 0, 0, 4115.718262, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4371.617676, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4110.391602, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2597.501953, 0, 0, 0, 0, 0, 0, 18119.19482, 3100.728271, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2847.687988, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5633.842529, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5135.368652, 0]


objects = list(frange(100, 2001, 4))


y_pos = np.arange(len(objects))

plt.bar(y_pos, mz)
plt.xlabel('m/z (Th)')
plt.ylabel('Intensity')
plt.title('Scan 12336 in m/z range [100,1300]')


protonMass =1.007276466879 

masses1 = [300.12224,401.16992,616.26052,703.29255,875.34096,1004.38355,1135.42404,174.11168,261.14370,360.21212,523.27545,652.31804,739.35007,852.43413,939.46616,1040.51384,1171.55432]
mzs1 = [x+ 1 for x in masses1]
converted1= [(x-100)/4 for x in mzs1]

plt.plot(converted1, [45000,30000,15000,25000,30000,45000,25000,30000,35000,20000,30000,35000,105000,65000,55000,40000,15000], 'ro', label="YHTSQSGDEMTSLSEYVSR")

masses2 = [260.11609,389.15869,460.19580,174.11168,400.27980,602.33878,673.37589,772.44430,859.47633,987.53491,1058.57202]
mzs2 = [x+ 1 for x in masses2]
converted2= [(x-100)/4 for x in mzs2]
plt.plot(converted2, [25000,25000,20000,20000,20000,45000,45000,25000,40000,35000,55000], 'r*', label="YPEAQSVASDILR")


masses3 =[242.12666,470.23766,146.10553,245.17394,344.24236,473.28495,703.37522,850.44363,978.53860]
mzs3 = [x+ 1 for x in masses3]
converted3= [(x-100)/4 for x in mzs3]
plt.plot(converted3, [75000,10000,35000,75000,10000,10000,35000,75000,15000], 'rs', label="EILDKFTEEVVK")


plt.xlim([0,200])
plt.xticks(np.arange(0,325,75), [100, 400, 700, 1000, 1300, 1600, 1900])

plt.legend()

###################

plt.tight_layout()

plt.savefig(r'C:\Users\stepa\Source\StefanPaper\fig5-coIsolationSpectrum.png', format='png', dpi=1200)

plt.show()

